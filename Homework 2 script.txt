Sub Stocks():

Dim total_stock As Double
Dim lrow As Long
Dim i, j As Integer
Dim ticker_sym As String

For Each ws In Worksheets

    ws.Activate
 
 lrow= ws.Cells(Rows.Count, 1).End(xlUp).Row

 ws.Range("I1").Value = "Ticker"
 ws.Range("J1").Value = "Total Stock Volume"

 total_stock = 0
 j = 2
 For i = 2 To lrow
     If ws.Range("A" & i + 1).Value = ws.Range("A" & i).Value Then
         total_stock = total_stock + ws.Range("G" & i).Value
     Else
         ticker_sym = ws.Range("A" & i).Value
         ws.Range("I" & j).Value = ticker_sym
         ws.Range("J" & j).Value = total_stock + Range("G" & i).Value
         j = j + 1
         total_stock = 0
     End If

 Next i
Next ws
End Sub